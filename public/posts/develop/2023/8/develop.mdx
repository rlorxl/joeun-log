---
title: 리액트에서 비동기로직 처리와 데이터 관리
category: develop
published: 2022-11-6
tags: 일상,개발
---

# 테스트

프론트엔드의 꽃은 비동기 요청 처리와 상태관리가 아닌가 생각한다.나는 리액트에서 비동기로직 처리와 데이터 관리를 어려워하고 이에 대한 고민을 많이 하곤했다.

Presigned URL은 미리 서명된 권한으로 잠시 접근가능하게 해주는 임시 url을 발급해주는 것이다. 파일에 접근하고 업로드(GET, POST)등 HTTP메소드를 사용할 수 있고 발급된 url의 만료기간을 설정할 수 있다.

## 파일 업로드 절차

1. 클라이언트에서 서버로 presigned url을 요청한다.
2. 서버에서 S3로 권한을 요청하고 클라이언트에 응답해준다.
3. 클라이언트에서 S3버킷으로 업로드한다.
   나는 Next js와 프리즈마 orm을 사용중이기 때문에 프리즈마 블로그에서 찾은 ‘Next js + prisma + typescript 이미지 업로드’부분을 참고했다! 여기서 나온 방식은 Presigned-POST방식이다.

Presigned POST방식은 Presigned URL하고는 약간 다른데 POST메서드만 사용할 수 있어서 업로드만 가능하다는 점이 다르다. 구현과정에서 우여곡절이 많았지만 업로드 성공한 코드를 올려본다.

```js
for (const post of posts) {
  const filePath = path.join(process.cwd(), rootDirectory, post);
  if (!filePath) continue;
  try {
    const fileContent = fs.readFileSync(filePath, 'utf8');
    const mdxSource = await bundleMDX({ source: fileContent });
    files.push(mdxSource);
  } catch (err) {
    // console.log(err);
  }
}
```
