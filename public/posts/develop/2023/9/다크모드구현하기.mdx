---
title: λ‹¤ν¬λ¨λ“ κµ¬ν„ - Next13 layout κ°•μ  λ¦¬λ λ”λ§
category: develop
published: 2023-9-22
keywords: Next13, λ‹¤ν¬λ¨λ“
description: 'λ‹¤ν¬λ¨λ“ κµ¬ν„ - Next13 layout κ°•μ  λ¦¬λ λ”λ§'
---

Next13κ³Ό cookieλ¥Ό μ‚¬μ©ν•΄ λ‹¤ν¬λ¨λ“λ¥Ό κµ¬ν„ν•λ©΄μ„ μƒκΈ΄ μ΄μμ™€ ν•΄κ²°λ²•.

<br />

# layout μ»΄ν¬λ„νΈ λ¦¬λ λ”λ§

λ‹¤ν¬λ¨λ“λ¥Ό κµ¬ν„ν•λ”λ° next-themesλ¥Ό μ‚¬μ©ν•΄μ„ νΈν•κ² λ‹¤ν¬λ¨λ“ μ„¤μ •μ„ ν•λ ¤κ³  ν–λ‹¤.

ν•μ§€λ§ λ‹¤ν¬λ¨λ“μΈ μƒνƒμ—μ„ μƒλ΅κ³ μΉ¨μ„ ν•λ©΄ λ°°κ²½μ΄ ν°μƒ‰μΌλ΅ ν•λ² λ³€ν–λ‹¤κ°€ λ‹¤ν¬λ¨λ“λ΅ λ°”λ€μ—λ‹¤.

> μ΄μ  :
> ν΄λΌμ΄μ–ΈνΈμ—μ„ useThemeλ¥Ό ν™•μΈν•ν›„ μ¤νƒ€μΌμ΄ μ…ν€μ§€λ”λ° μ„λ²„ μ»΄ν¬λ„νΈ μ‹¤ν–‰ν›„μ— ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈκ°€ μ‹¤ν–‰λκΈ° λ•λ¬Έμ— htmlνƒκ·Έμ— classκ°€ μ μ©λλ” μ‹μ κ³Ό DOMνΈλ¦¬κ°€ κµ¬μ„±λλ” μ‹μ μ— μ°¨μ΄κ°€ μμ–΄μ„ κΈ°λ³ΈμΈ ν°ν™”λ©΄μ΄ λ¨Όμ € λ λ”λ§λλ‹¤.

λ”°λΌμ„ scriptνμΌμ„ μ½κΈ° μ „μ— μ„λ²„λ‹¨μ—μ„ λ―Έλ¦¬ λ‹¤ν¬λ¨λ“ μ μ©μ΄ λμ–΄μκ² λ§λ“¤μ–΄μ•Ό ν•λ‹¤.

μΏ ν‚¤λ¥Ό μ΄μ©ν•΄μ„ λ²„νΌμ΄ λλ¦΄λ•λ§λ‹¤ μΏ ν‚¤μ— ν…λ§κ°€ μ €μ¥λκ² ν•κ³  bodyμ—λ” data-themeμ†μ„±μ„ μ¶”κ°€ν•΄ μΏ ν‚¤κ°’μ— λ”°λΌμ„ μ¤νƒ€μΌμ΄ λ°”λ€λ„λ΅ κµ¬ν„ν–λ‹¤.

```js
[data-theme='dark'] {
    background-color: var(--darkmode-base-color);
    color: var(--darkmode-text-color);
 }
```

<br />

ν•μ§€λ§ μ²μμ— ν…λ§λ³€κ²½ μ΄ν›„μ— μ΄λ²¤νΈκ°€ λ¨Ήμ§€ μ•μ•λ‹¤.

μΏ ν‚¤λ¥Ό ν™•μΈν•΄λ³΄λ‹ μΏ ν‚¤λ” λ³€κ²½μ΄ λκ³  data-theme κ°’λ§ λ³€κ²½λμ§€ μ•λ”λ‹¤.

μ΄μ λ” layoutμ€ λ¦¬λ λ”λ§μ΄ λ°μƒν•μ§€ μ•κΈ° λ•λ¬Έμ΄μ—λ‹¤.

<br />

**π” λ‹¤μ‹ next-themeλ¥Ό μ‚¬μ©ν•΄μ„ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμ—μ„ useThemeλ΅ data-themeλ¥Ό λ³€κ²½ν•λ©΄ μ•λ κΉ?**

κ°€λ¥ν•μ§€λ§ μλ―Έκ°€ μ—†λ‹¤. μ•μ„ λ§ν–λ“― ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ λ§μ΄νΈ μ‹μ  μ΄μ „μ— μ¤νƒ€μΌμ„ λ³€κ²½μ‹μΌμ•Όν•λ‹¤.

μ΄λ²¤νΈκ°€ λ°μƒν•  λ•λ§λ‹¤ RootLayoutμ—μ„ μΏ ν‚¤λ¥Ό κ°€μ Έμ¤λ” ν•¨μκ°€ μ‹¤ν–‰λμ–΄μ•Όν•λ‹¤.

ν΄λΌμ΄μ–ΈνΈμ—μ„ μ΄λ²¤νΈκ°€ λ°μƒν–μ„ λ• μ„λ²„ μ»΄ν¬λ„νΈκ°€ νΈλ¦¬κ±° λ  μ μλ” λ°©λ²•, μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό κ°•μ  λ λ”λ§ν•λ” λ°©λ²•μ„ μ°Ύμ•„λ΄¤λ‹¤.

λΉ„μ·ν• μ΄μλ΅ μ§λ¬Έν• κΈ€μ„ μ°Ύμ•λ‹¤.

[https://www.reddit.com/r/nextjs/comments/13egbrc/force_rerender_of_the_layout/?rdt=53005](https://www.reddit.com/r/nextjs/comments/13egbrc/force_rerender_of_the_layout/?rdt=53005)

<br />

λ‹µλ³€μ—μ„ κ³µμ‹λ¬Έμ„λ΅ λ“¤μ–΄κ° μ μμ—λ”λ°

κ²°λ΅ μ€ routerλ¥Ό μ΄μ©ν•λ©΄ λλ‹¤.

ν΄λΌμ΄μ–ΈνΈμ—μ„ **router.refresh()** λ΅ μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό κ°•μ  λ¦¬λ λ”λ§ ν•  μ μλ‹¤. [π”— use-router](https://nextjs.org/docs/app/api-reference/functions/use-router)

---

# μµμ΄ λ λ”λ§μ‹ μΏ ν‚¤ μ €μ¥ν•κΈ°

μΏ ν‚¤κ°€ μ €μ¥μ΄ λμ–΄μμ„λ• λ§κ³  μµμ΄μ— λ¨λ“λ¥Ό μ„¤μ •ν•λ”κ² ν•„μ”ν•λ° κ·Έκ±Έ κΉλ¨Ήμ—λ‹¤..

```js
// app/layout.tsx

const theme = getCookie();

<body data-theme={theme.value}>
  <main className={`${sofia.className} w-full min-h-screen relative flex-col flex-center`}>
    <RecoilRootWrapper>{children}</RecoilRootWrapper>
  </main>
</body>;
```

μ²μ μ‹¤ν–‰λμ—μ„λ•λ” themeκ°’μ΄ undefinedμ΄κΈ° λ•λ¬Έμ— data-themeκ°€ μ¶”κ°€λμ§€ μ•λ”λ‹¤.

getCookieν•¨μ λ‚΄λ¶€μ—μ„ μΏ ν‚¤κ°’μ„ ν™•μΈν•΄μ„ μ—†μΌλ©΄ ν…λ§ κΈ°λ³Έμ„¤μ •μ„ ν™•μΈν•λ” μ½”λ“λ¥Ό λ„£μ–΄μ„ themeμ— λ°ν™λλ” κ°’μ„ λ‹¤λ¥΄κ² ν•λ ¤κ³  ν–λ”λ°

λ¬Έμ λ” next13μ—μ„λ” μ„λ²„ μ»΄ν¬λ„νΈ μ•μ—μ„ μ „μ—­κ°μ²΄λ‚ λ¦¬μ•΅νΈ ν›…μ„ λ‹¤μ΄λ ‰νΈλ΅ μ‚¬μ©ν•  μ μ—†κΈ° λ•λ¬Έμ— λΈλΌμ°μ €μ κΈ°λ³Έ ν…λ§ μ„¤μ •μ„ ν™•μΈν•  λ• windowκ°μ²΄κ°€ ν•„μ”ν•λ° μ΄κ±Έ μ“Έ μκ°€ μ—†λ‹¤.

μ΄κ²ƒ λ•λ¬Έμ— μΏ ν‚¤λ¥Ό κ°€μ Έμ¬λ•λ” nextμ cookiesλ¥Ό μ‚¬μ©ν•κ³ , μ €μ¥ν•  λ•λ” κΈ°λ³Έ windowκ°μ²΄λ¥Ό μ΄μ©ν•λ” μ½”λ“λ¥Ό μ“°κ³  μλ‹¤.

[π”— composition-patterns](https://nextjs.org/docs/app/building-your-application/rendering/composition-patterns#supported-pattern-passing-server-components-to-client-components-as-props)

κ³µμ‹λ¬Έμ„λ¥Ό ν™•μΈν•΄λ³΄λ©΄ **μ„λ²„ μ»΄ν¬λ„νΈλ¥Ό ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμ propsλ΅ λ„κΈΈ μ μκ³  ν•΄λ‹Ή ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ¥Ό rootlayoutκ³Ό κ°™μ€ λ¶€λ¨ μ„λ²„ μ»΄ν¬λ„νΈμ—μ„ λ¶λ¬μ™€μ„ μ‚¬μ©ν•  μ μλ‹¤**κ³  ν•λ‹¤.

Context Providersλ¶€λ¶„μ„ ν™•μΈν•λ©΄ useContextμ‚¬μ©μ‹μ—λ„ Providerλ¥Ό μ„λ²„ μ»΄ν¬λ„νΈμ—μ„ λ‹¤μ΄λ ‰νΈλ΅ μ‚¬μ©ν•μ§€ λ§κ³  **ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ κ°μ‹Έμ„ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ λ‚΄λ¶€μ—μ„ useContextλ¥Ό μ‚¬μ©ν•κ³  ν•΄λ‹Ή ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ¥Ό layoutμ—μ„ μ‚¬μ©**ν•λ”λ“± λνΌμ»΄ν¬λ„νΈλ¥Ό λ§λ“¤μ–΄μ„ μ“°λΌκ³  λμ–΄μλ‹¤.

κ²°λ΅ μ μΌλ΅ κΈ°λ³Έ ν…λ§μ„¤μ •μ„ ν™•μΈν•λ” λ©μ μ λνΌ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ¥Ό λ§λ“¤κ³  μµμ΄ λ λ”λ§μ‹μ—λ” λνΌ μ»΄ν¬λ„νΈμ useEffectμ•μ—μ„ κΈ°λ³Έμ„¤μ •μ„ ν™•μΈν• ν›„ data-themeκ°’μΌλ΅ ν• λ‹Ήν•΄μ„ layoutμΌλ΅ λ¦¬ν„΄λλ„λ΅ μ΄κΈ°μ…‹ν…μ„ ν•κ³  μ΄ν›„μ— μΏ ν‚¤κ°€ μ΅΄μ¬ν•  λ•λ” μΏ ν‚¤κ°’μ„ propsλ΅ μ „λ‹¬ν•΄μ„ λ§μ΄νΈ μ΄μ „μ— data-themeκ°’μ΄ ν• λ‹Ήλλ„λ΅ μμ •ν–λ‹¤.

```js
// app/layout.tsx

const RootLayout = ({ children }: { children: React.ReactNode }) => {
  const theme = getCookie();

  return (
    <html lang="en">
      <CheckDefaultScheme cookie={theme}>
        <main className={`${sofia.className} w-full min-h-screen relative flex-col flex-center`}>
          <RecoilRootWrapper>{children}</RecoilRootWrapper>
        </main>
      </CheckDefaultScheme>
    </html>
  );
};

export default RootLayout;


// default-scheme.tsx
'use client';
...
const CheckDefaultScheme = ({
  children,
  cookie,
}: {
  children: React.ReactNode;
  cookie?: RequestCookie;
}) => {
  const [defaultScheme, setDefaultScheme] = useState<string | null>(null);

  useEffect(() => {
    const isDarkmode = window.matchMedia(MEDIA).matches;

    if (!isDarkmode) {
      setCookie(LIGHT_MODE);
    } else {
      setCookie(DARK_MODE);
      setDefaultScheme(DARK_MODE);
    }
  }, []);

  if (cookie) return <body data-theme={cookie.value}>{children}</body>;

  return <body data-theme={defaultScheme}>{children}</body>;
};

export default CheckDefaultScheme;
```
